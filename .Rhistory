summarize(n.observationsTo = n(), n.observateurs = n_distinct(recordedBy) ) %>% #crée deux nouvelles colonnes
#nombre d'observations = nombre de ligne alouette par an
#nombre d'observateurs = nombre de noms différents ayant fait ces observations d'alouettes par an
mutate(ratio1 = n.observationsTo/n.observateurs) #nouvelle colonne qui résume le ratio des deux
ratio.tablTo = left_join(sum.obs,sum.tourt,by="year") %>%
mutate(ratio2 = n.observationsTo/n.observationstot) #%>%
#filter(year != 2014,year !=2001)
ratio.alouettenbobse <- left_join(sum.obs, sum.alouette, by = "year") %>%
mutate(ratio2 = n.observationsAl / n.observationstot) %>%
mutate(ratio2_norm = ratio2 / ratio2[year == 2002])
#diviser les valeurs par celle de 2001
ggplot(ratio.alouettenbobse,aes(x=year, y = ratio2_norm)) +
#geom_path(lineend = "butt",linejoin = "round", linemitre = 1) +
#geom_point()
geom_line()+
geom_smooth(method = lm) +
labs(x = "Années", y = "nombre d'observation d'alouette sur le nombre d'observations totales",
title ="nombre d'observation d'alouette sur le nombre d'observations totales en fonction des années except 2001 et 2014",
caption = "PIR science Part")
ggplot(data = ratio.alouettenbobse, aes(x = year, y = ratio2_norm)) +
stat_poly_line() +
stat_poly_eq(use_label(c("eq", "adj.R2", "f", "p", "n", "R2.confint"))) +
geom_point() +
theme_classic()
a <- round(coeffs[1, 1], 4)  # Intercept
# Calcul de la régression linéaire
model <- lm(ratio2_norm ~ year, data = ratio.alouettenbobse)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
# Création du texte de la légende
legend_text <- paste0("y = ", a, " + ", b, "x\n",
"R² = ", r2, "\n",
"p-value = ", p_value, "\n",
"IC 95%: [", conf_low, ", ", conf_high, "]")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 3,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 1.05,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 4, color = "black")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 5,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 1.05,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 4, color = "black")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 0,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 1.05,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 4, color = "black")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 0,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 4, color = "black")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 0,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 0,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3.5, color = "black")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 0,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 0.8,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3.5, color = "black")
ggplot(ratio.alouettenbobse, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'red', color = 'red') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'red', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.alouettenbobse$year) - 0,  # Déplacement à droite
y = max(ratio.alouettenbobse$ratio2_norm) * 0.95,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3.5, color = "black")
model <- lm(ratio2_norm ~ year, data = ratio.tablCh)
ratio.tablCh <- left_join(sum.obs, sum.charbo, by = "year") %>%
mutate(ratio2 = n.observationsCh / n.observationstot) %>%
mutate(ratio2_norm = ratio2 / ratio2[year == 2001])
#diviser les valeurs par celle de 2001
model <- lm(ratio2_norm ~ year, data = ratio.tablCh)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
# Création du texte de la légende
legend_text <- paste0("y = ", a, " + ", b, "x\n",
"R² = ", r2, "\n",
"p-value = ", p_value, "\n",
"IC 95%: [", conf_low, ", ", conf_high, "]")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = max(ratio.tablCh$ratio2_norm) * 1.05,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 4, color = "black")
# Graphique avec ggplot
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = max(ratio.tablCh$ratio2_norm) * 1.05,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = max(ratio.tablCh$ratio2_norm) * 1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = max(ratio.tablCh$ratio2_norm) * 0.95,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = max(ratio.tablCh$ratio2_norm) * 0.05,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = max(ratio.tablCh$ratio2_norm) * 0.45,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = min(ratio.tablCh$ratio2_norm) * 1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 3,  # Déplacement à droite
y = min(ratio.tablCh$ratio2_norm) * 1.1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de l'Alouette des champs au cours des années",
caption = "PIR Science Participative", subtitle = "Alauda arvensis") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 6,  # Déplacement à droite
y = min(ratio.tablCh$ratio2_norm) * 1.1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
View(data.bret)
ggplot(ratio.tablCh, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'purple', color = 'purple') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de la mésange charbonière au cours des années",
caption = "PIR Science Participative", subtitle = "Parus major") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'purple', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablCh$year) - 6,  # Déplacement à droite
y = min(ratio.tablCh$ratio2_norm) * 1.1,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3, color = "black")
summary_model
model <- lm(ratio2_norm ~ year, data = ratio.tablCh)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
# Création du texte de la légende
legend_text <- paste0("y = ", a, " + ", b, "x\n",
"R² = ", r2, "\n",
"p-value = ", p_value, "\n",
"IC 95%: [", conf_low, ", ", conf_high, "]")
summary_model
model <- lm(ratio2_norm ~ year, data = ratio.tablCh)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
# Création du texte de la légende
legend_text <- paste0("y = ", a, " + ", b, "x\n",
"R² = ", r2, "\n",
"p-value = ", p_value, "\n",
"IC 95%: [", conf_low, ", ", conf_high, "]")
model <- lm(ratio2_norm ~ year, data = ratio.alouettenbobse)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
summary_model
model <- lm(ratio2_norm ~ year, data = ratio.tablCh)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
summary_model
ratio.tablCh <- left_join(sum.obs, sum.charbo, by = "year") %>%
mutate(ratio2 = n.observationsCh / n.observationstot) %>%
mutate(ratio2_norm = ratio2 / ratio2[year == 2001])
#diviser les valeurs par celle de 2001
View(ratio.tablCh)
model <- lm(ratio2_norm ~ year, data = ratio.tablTo)
ratio.tablTo <- left_join(sum.obs, sum.tourt, by = "year") %>%
mutate(ratio2 = n.observationsTo / n.observationstot) %>%
mutate(ratio2_norm = ratio2 / ratio2[year == 2001])
#diviser les valeurs par celle de 2001
model <- lm(ratio2_norm ~ year, data = ratio.tablTo)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
# Création du texte de la légende
legend_text <- paste0("y = ", a, " + ", b, "x\n",
"R² = ", r2, "\n",
"p-value = ", p_value, "\n",
"IC 95%: [", conf_low, ", ", conf_high, "]")
ggplot(ratio.tablTo, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'blue', color = 'blue') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de la Tourterelle des bois au cours des années",
caption = "PIR Science Participative", subtitle = "Streptopelia turtur") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'blue', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablTo$year) - 3,  # Déplacement à droite
y = max(ratio.tablTo$ratio2_norm) * 1.05,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 4, color = "black")
ggplot(ratio.tablTo, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'blue', color = 'blue') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de la Tourterelle des bois au cours des années",
caption = "PIR Science Participative", subtitle = "Streptopelia turtur") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'blue', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablTo$year) - 0,  # Déplacement à droite
y = max(ratio.tablTo$ratio2_norm) * 0.95,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3.5, color = "black")
ggplot(ratio.tablTo, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'blue', color = 'blue') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative de la Tourterelle des bois au cours des années",
caption = "PIR Science Participative", subtitle = "Streptopelia turtur") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'blue', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.tablTo$year) - 0,  # Déplacement à droite
y = max(ratio.tablTo$ratio2_norm) * 0.9,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3.5, color = "black")
View(ratio.BJobsparotot)
View(ratio.alouettenbobse)
View(ratio.BJobsparotot)
View(ratio.tablCh)
View(ratio.tablCh)
View(ratio.tablTo)
ratio.BJobsparotot <- left_join(sum.obs, sum.bj, by = "year") %>%
mutate(ratio2 = n.observationsBJ / n.observationstot) %>%
mutate(ratio2_norm = ratio2 / ratio2[year == 2001])
#diviser les valeurs par celle de 2001
model <- lm(ratio2_norm ~ year, data = ratio.BJobsparotot)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
yellow
# Calcul de la régression linéaire
model <- lm(ratio2_norm ~ year, data = ratio.BJobsparotot)
summary_model <- summary(model)
coeffs <- summary_model$coefficients
# Extraction des valeurs importantes
a <- round(coeffs[1, 1], 4)  # Intercept
b <- round(coeffs[2, 1], 4)  # Pente
r2 <- round(summary_model$r.squared, 4)  # R²
p_value <- round(coeffs[2, 4], 4)  # p-value de la pente
# Calcul des intervalles de confiance à 95%
conf_int <- confint(model, level = 0.95)
conf_low <- round(conf_int[2, 1], 4)
conf_high <- round(conf_int[2, 2], 4)
legend_text <- paste0("y = ", a, " + ", b, "x\n",
"R² = ", r2, "\n",
"p-value = ", p_value, "\n",
"IC 95%: [", conf_low, ", ", conf_high, "]")
ggplot(ratio.BJobsparotot, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'orange', color = 'orange') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative du Bruant jaune au cours des années",
caption = "PIR Science Participative", subtitle = "Emberiza citrinellar") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'orange', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.BJobsparotot$year) - 0,  # Déplacement à droite
y = max(ratio.BJobsparotot$ratio2_norm) * 0.9,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3.5, color = "black")
ggplot(ratio.BJobsparotot, aes(x = year)) +
geom_smooth(aes(y = ratio2_norm), method = lm, fill = 'orange', color = 'orange') +
labs(x = "Années", y = "Abondance relative",
title = "Abondance relative du Bruant jaune au cours des années",
caption = "PIR Science Participative", subtitle = "Emberiza citrinella") +
theme_classic() +
geom_point(aes(y = ratio2_norm), colour = 'orange', size = 1) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
annotate("text", x = max(ratio.BJobsparotot$year) - 0,  # Déplacement à droite
y = max(ratio.BJobsparotot$ratio2_norm) * 0.9,  # Déplacement vers le haut
label = legend_text, hjust = 1, size = 3.5, color = "black")
library(dplyr) #permet d'utiliser %>%, filter, summarize et bien d'autres.
library(sf) #pour manipuler des objets spatiaux
library(ggplot2)  #pour les graphiques
dep35 <- st_read("data/departement-35/admin-departement.shp")
dep22 <- st_read("data/departement-22/admin-departement.shp")
dep56 <- st_read("data/departement-56/admin-departement.shp")
dep29 <- st_read("data/departement-29/admin-departement.shp")
dep35_22 = st_union(dep35,dep22)
plot(st_geometry(dep35_22))
dep56_29 = st_union(dep56,dep29)
plot(st_geometry(dep56_29))
#rassembler les deux polygones qui en résultent pour obtenir la Bretagne
Bret = st_union(dep35_22,dep56_29)
plot(st_geometry(Bret))
ggplot() +
geom_sf(data = Bret, fill = "white", color = "black") + # Contour du département35
geom_sf(data = alouette.bret, color = "blue", size = 1, alpha = 0.2) + # Observations d'alouettes extraites
theme_minimal() + #juste pour l'esthétique
ggtitle("Observations (STOC-eps) d'alouettes des champs en Bretagne") #ajout d'un titre
library(tmap)
tmap_mode("view")
tm_shape(charbo.bret) +
tm_dots(col = "grey", size = 0.1)+
tm_shape(bruantj.bret) +
tm_dots(col = "yellow", size = 0.1)+ #trace les points, size définit leur taille
tm_shape(alouette.bret) +
tm_dots(col = "brown", size = 0.1)+
tm_layout(title = "Observations des espèces (STOC-EPS) en Bretagne",
legend.show = TRUE,
legend.outside = TRUE)
ggplot() +
geom_sf(data = Bret, fill = "white", color = "black") + # Contour du département35
geom_sf(data = alouette.bret, color = "blue", size = 1, alpha = 0.2) + # Observations d'alouettes extraites
theme_minimal() + #juste pour l'esthétique
ggtitle("Observations (STOC-eps) d'alouettes des champs en Bretagne") #ajout d'un titre
ggplot() +
geom_sf(data = Bret, fill = "white", color = "black")
alouette.bret = st_as_sf(alouette.bret,coords = c("decimalLongitude","decimalLatitude"), crs = 4326)
View(alouette.bret)
View(data.bret)
View(data.bret)
View(alouette.bret)
mydat = read.csv2("data/0041794-241126133413365.csv", sep = '\t') # note pour Océane: pense à mettre le fichier de données dans le dossier STOC_Bret/data !
View(mydat)
View(mydat)
